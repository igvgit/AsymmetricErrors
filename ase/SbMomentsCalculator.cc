#include <cmath>
#include <cassert>
#include <stdexcept>
#include <limits>

#include "ase/mathUtils.hh"
#include "ase/specialFunctions.hh"
#include "ase/SbMomentsCalculator.hh"

#define SQRT2L 1.414213562373095048801689L
#define TAILTERMS 189
#define SQRPI 1.77245385090551602729816748334L
#define SMALL_A_BOUND 1.0L

#ifdef VERBOSE_CALC
#undef VERBOSE_CALC
#endif

// #define VERBOSE_CALC

#ifdef VERBOSE_CALC
#include <iostream>
#endif

typedef long double Real;

static bool my_inf_nan(long double x)
{
    volatile long double temp = x;
    return ((temp - x) != 0.0L);
}

static Real inverseErf(const Real fval)
{
    Real x = ase::inverseGaussCdf((fval + 1.0L)/2.0L)/SQRT2L;
    for (unsigned i=0; i<2; ++i)
    {
        const Real guessed = erfl(x);
        const Real deri = 2.0L/SQRPI*expl(-x*x);
        x += (fval - guessed)/deri;
    }
    return x;
}

// The following function returns erfc(x)/exp(-x^2) for non-negative x
static Real erfc_exp_factor(const Real x)
{
    // In Mathematica:
    // s = Normal[Series[Erfc[Sqrt[x]]/Exp[-x]*Sqrt[x]*Sqrt[Pi],{x,Infinity,50}]]
    // t = Table[Coefficient[s, x, i], {i, 0, -50, -1}]
    // N[t, 30]//CForm
    static const Real coeffs[] = {
    1.L, -0.5L, 0.75L, -1.875L, 6.5625L, 
    -29.53125L, 162.421875L, -1055.7421875L, 
    7918.06640625L, -67303.564453125L, 
    639383.8623046875L, -6.71353055419921875e6L, 
    7.7205601373291015625e7L, -9.650700171661376953125e8L, 
    1.302844523174285888671875e10L, -1.88912455860271453857421875e11L, 
    2.9281430658342075347900390625e12L, -4.83143605862644243240356445312e13L, 
    8.45501310259627425670623779297e14L, -1.5641774239803107374906539917e16L, 
    3.05014597676160593810677528381e17L, -6.25279925236129217311888933182e18L, 
    1.34435183925767781722056120634e20L, -3.02479163832977508874626271427e21L, 
    7.10826035007497145855371737853e22L, -1.74152378576836800734566075774e24L, 
    4.44088565370933841873143493223e25L, -1.17683469823297468096383025704e27L, 
    3.23629542014068037265053320687e28L, -9.22344194740093906205401963957e29L, 
    2.72091537448327702330593579367e31L, -8.2987918921739949210831041707e32L, 
    2.61411944603480840014117781377e34L, -8.49588819961312730045882789476e35L, 
    2.84612254687039764565370734474e37L, -9.81912278670287187750529033936e38L, 
    3.48578858927951951651437807047e40L, -1.27231283508702462352774799572e42L, 
    4.77117313157634233822905498396e43L, -1.83690165565689180021818616883e45L, 
    7.25576153984472261086183536686e46L, -2.93858342363711265739904332358e48L, 
    1.21951212080940175282060297928e50L, -5.18292651343995744948756266196e51L, 
    2.25457303334638149052708975795e53L, -1.00328499983913976328455494229e55L, 
    4.56494674926808592294472498742e56L, -2.12270023840965995416929711915e58L, 
    1.0082826132445884782304161316e60L, -4.89017067423625411941751823824e61L, 
    2.42063448374694578911167152793e63L};
    static const int degree = sizeof(coeffs)/sizeof(coeffs[0])-1;

    assert(x >= 0.0L);
    if (x >= 20.0L)
        return ase::polySeriesSum(coeffs, degree, 1.0L/x/x)/x/SQRPI;
    else
        return erfcl(x)/expl(-x*x);
}

//
// In Mathematica:
//
// tailterms = 189
// Table[(-1)^k, {k, 0, tailterms-1}]//CForm
// Table[(-1)^k (k+1), {k, 0, tailterms-1}]//CForm
// Table[(-1)^k (k+1) (k+2)/2, {k, 0, tailterms-1}]//CForm
// Table[(-1)^k (k+1) (k+2) (k+3)/2/3, {k, 0, tailterms-1}]//CForm
// Table[(-1)^k (k+1) (k+2) (k+3) (k+4)/2/3/4, {k, 0, tailterms-1}]//CForm
// Table[(-1)^k (k+1)(k+2)(k+3)(k+4)(k+5)/2/3/4/5, {k, 0, tailterms-1}]//CForm
//
static const int pos_tail_coeff[6][TAILTERMS] = {
    {
    1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,
    1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,
    -1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,
    1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,
    -1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,
    1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,
    -1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1
    },
    {
    1,-2,3,-4,5,-6,7,-8,9,-10,11,-12,13,-14,15,-16,17,-18,19,-20,21,-22,
    23,-24,25,-26,27,-28,29,-30,31,-32,33,-34,35,-36,37,-38,39,-40,41,-42,43,
    -44,45,-46,47,-48,49,-50,51,-52,53,-54,55,-56,57,-58,59,-60,61,-62,63,-64,
    65,-66,67,-68,69,-70,71,-72,73,-74,75,-76,77,-78,79,-80,81,-82,83,-84,85,
    -86,87,-88,89,-90,91,-92,93,-94,95,-96,97,-98,99,-100,101,-102,103,-104,
    105,-106,107,-108,109,-110,111,-112,113,-114,115,-116,117,-118,119,-120,
    121,-122,123,-124,125,-126,127,-128,129,-130,131,-132,133,-134,135,-136,
    137,-138,139,-140,141,-142,143,-144,145,-146,147,-148,149,-150,151,-152,
    153,-154,155,-156,157,-158,159,-160,161,-162,163,-164,165,-166,167,-168,
    169,-170,171,-172,173,-174,175,-176,177,-178,179,-180,181,-182,183,-184,
    185,-186,187,-188,189
    },
    {
    1,-3,6,-10,15,-21,28,-36,45,-55,66,-78,91,-105,120,-136,153,-171,190,
    -210,231,-253,276,-300,325,-351,378,-406,435,-465,496,-528,561,-595,630,
    -666,703,-741,780,-820,861,-903,946,-990,1035,-1081,1128,-1176,1225,-1275,
    1326,-1378,1431,-1485,1540,-1596,1653,-1711,1770,-1830,1891,-1953,2016,
    -2080,2145,-2211,2278,-2346,2415,-2485,2556,-2628,2701,-2775,2850,-2926,
    3003,-3081,3160,-3240,3321,-3403,3486,-3570,3655,-3741,3828,-3916,4005,
    -4095,4186,-4278,4371,-4465,4560,-4656,4753,-4851,4950,-5050,5151,-5253,
    5356,-5460,5565,-5671,5778,-5886,5995,-6105,6216,-6328,6441,-6555,6670,
    -6786,6903,-7021,7140,-7260,7381,-7503,7626,-7750,7875,-8001,8128,-8256,
    8385,-8515,8646,-8778,8911,-9045,9180,-9316,9453,-9591,9730,-9870,10011,
    -10153,10296,-10440,10585,-10731,10878,-11026,11175,-11325,11476,-11628,
    11781,-11935,12090,-12246,12403,-12561,12720,-12880,13041,-13203,13366,
    -13530,13695,-13861,14028,-14196,14365,-14535,14706,-14878,15051,-15225,
    15400,-15576,15753,-15931,16110,-16290,16471,-16653,16836,-17020,17205,
    -17391,17578,-17766,17955
    },
    {
    1,-4,10,-20,35,-56,84,-120,165,-220,286,-364,455,-560,680,-816,969,
    -1140,1330,-1540,1771,-2024,2300,-2600,2925,-3276,3654,-4060,4495,-4960,
    5456,-5984,6545,-7140,7770,-8436,9139,-9880,10660,-11480,12341,-13244,
    14190,-15180,16215,-17296,18424,-19600,20825,-22100,23426,-24804,26235,
    -27720,29260,-30856,32509,-34220,35990,-37820,39711,-41664,43680,-45760,
    47905,-50116,52394,-54740,57155,-59640,62196,-64824,67525,-70300,73150,
    -76076,79079,-82160,85320,-88560,91881,-95284,98770,-102340,105995,
    -109736,113564,-117480,121485,-125580,129766,-134044,138415,-142880,
    147440,-152096,156849,-161700,166650,-171700,176851,-182104,187460,
    -192920,198485,-204156,209934,-215820,221815,-227920,234136,-240464,
    246905,-253460,260130,-266916,273819,-280840,287980,-295240,302621,
    -310124,317750,-325500,333375,-341376,349504,-357760,366145,-374660,
    383306,-392084,400995,-410040,419220,-428536,437989,-447580,457310,
    -467180,477191,-487344,497640,-508080,518665,-529396,540274,-551300,
    562475,-573800,585276,-596904,608685,-620620,632710,-644956,657359,
    -669920,682640,-695520,708561,-721764,735130,-748660,762355,-776216,
    790244,-804440,818805,-833340,848046,-862924,877975,-893200,908600,
    -924176,939929,-955860,971970,-988260,1004731,-1021384,1038220,-1055240,
    1072445,-1089836,1107414,-1125180,1143135
    },
    {
    1,-5,15,-35,70,-126,210,-330,495,-715,1001,-1365,1820,-2380,3060,
    -3876,4845,-5985,7315,-8855,10626,-12650,14950,-17550,20475,-23751,27405,
    -31465,35960,-40920,46376,-52360,58905,-66045,73815,-82251,91390,-101270,
    111930,-123410,135751,-148995,163185,-178365,194580,-211876,230300,
    -249900,270725,-292825,316251,-341055,367290,-395010,424270,-455126,
    487635,-521855,557845,-595665,635376,-677040,720720,-766480,814385,
    -864501,916895,-971635,1028790,-1088430,1150626,-1215450,1282975,-1353275,
    1426425,-1502501,1581580,-1663740,1749060,-1837620,1929501,-2024785,
    2123555,-2225895,2331890,-2441626,2555190,-2672670,2794155,-2919735,
    3049501,-3183545,3321960,-3464840,3612280,-3764376,3921225,-4082925,
    4249575,-4421275,4598126,-4780230,4967690,-5160610,5359095,-5563251,
    5773185,-5989005,6210820,-6438740,6672876,-6913340,7160245,-7413705,
    7673835,-7940751,8214570,-8495410,8783390,-9078630,9381251,-9691375,
    10009125,-10334625,10668000,-11009376,11358880,-11716640,12082785,
    -12457445,12840751,-13232835,13633830,-14043870,14463090,-14891626,
    15329615,-15777195,16234505,-16701685,17178876,-17666220,18163860,
    -18671940,19190605,-19720001,20260275,-20811575,21374050,-21947850,
    22533126,-23130030,23738715,-24359335,24992045,-25637001,26294360,
    -26964280,27646920,-28342440,29051001,-29772765,30507895,-31256555,
    32018910,-32795126,33585370,-34389810,35208615,-36041955,36890001,
    -37752925,38630900,-39524100,40432700,-41356876,42296805,-43252665,
    44224635,-45212895,46217626,-47239010,48277230,-49332470,50404915,
    -51494751,52602165,-53727345,54870480
    },
    {
    1,-6,21,-56,126,-252,462,-792,1287,-2002,3003,-4368,6188,-8568,11628,
    -15504,20349,-26334,33649,-42504,53130,-65780,80730,-98280,118755,-142506,
    169911,-201376,237336,-278256,324632,-376992,435897,-501942,575757,
    -658008,749398,-850668,962598,-1086008,1221759,-1370754,1533939,-1712304,
    1906884,-2118760,2349060,-2598960,2869685,-3162510,3478761,-3819816,
    4187106,-4582116,5006386,-5461512,5949147,-6471002,7028847,-7624512,
    8259888,-8936928,9657648,-10424128,11238513,-12103014,13019909,-13991544,
    15020334,-16108764,17259390,-18474840,19757815,-21111090,22537515,
    -24040016,25621596,-27285336,29034396,-30872016,32801517,-34826302,
    36949857,-39175752,41507642,-43949268,46504458,-49177128,51971283,
    -54891018,57940519,-61124064,64446024,-67910864,71523144,-75287520,
    79208745,-83291670,87541245,-91962520,96560646,-101340876,106308566,
    -111469176,116828271,-122391522,128164707,-134153712,140364532,-146803272,
    153476148,-160389488,167549733,-174963438,182637273,-190578024,198792594,
    -207288004,216071394,-225150024,234531275,-244222650,254231775,-264566400,
    275234400,-286243776,297602656,-309319296,321402081,-333859526,346700277,
    -359933112,373566942,-387610812,402073902,-416965528,432295143,-448072338,
    464306843,-481008528,498187404,-515853624,534017484,-552689424,571880029,
    -591600030,611860305,-632671880,654045930,-675993780,698526906,-721656936,
    745395651,-769754986,794747031,-820384032,846678392,-873642672,901289592,
    -929632032,958683033,-988455798,1018963693,-1050220248,1082239158,
    -1115034284,1148619654,-1183009464,1218218079,-1254260034,1291150035,
    -1328902960,1367533860,-1407057960,1447490660,-1488847536,1531144341,
    -1574397006,1618621641,-1663834536,1710052162,-1757291172,1805568402,
    -1854900872,1905305787,-1956800538,2009402703,-2063130048,2118000528
    }
};

//
// In Mathematica:
//
// tailterms = 189
// Table[-(-1)^k, {k, 0, tailterms-1}]//CForm
// Table[(-1)^k (k-1), {k, 0, tailterms-1}]//CForm
// Table[-(-1)^k (k-1) (k-2)/2, {k, 0, tailterms-1}]//CForm
// Table[(-1)^k (k-1) (k-2) (k-3)/2/3, {k, 0, tailterms-1}]//CForm
// Table[-(-1)^k (k-1) (k-2) (k-3) (k-4)/2/3/4, {k, 0, tailterms-1}]//CForm
// Table[(-1)^k (k-1)(k-2)(k-3)(k-4)(k-5)/2/3/4/5, {k, 0, tailterms-1}]//CForm
//
// Then reset every 0th term in the sub-array to 0
//
static const int neg_tail_coeff[6][TAILTERMS] = {
    {
     0,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,
    -1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,
    1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,
    -1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,
    1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,
    -1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,
    1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1
    },
    {
     0,0,1,-2,3,-4,5,-6,7,-8,9,-10,11,-12,13,-14,15,-16,17,-18,19,-20,21,
    -22,23,-24,25,-26,27,-28,29,-30,31,-32,33,-34,35,-36,37,-38,39,-40,41,-42,
    43,-44,45,-46,47,-48,49,-50,51,-52,53,-54,55,-56,57,-58,59,-60,61,-62,63,
    -64,65,-66,67,-68,69,-70,71,-72,73,-74,75,-76,77,-78,79,-80,81,-82,83,-84,
    85,-86,87,-88,89,-90,91,-92,93,-94,95,-96,97,-98,99,-100,101,-102,103,
    -104,105,-106,107,-108,109,-110,111,-112,113,-114,115,-116,117,-118,119,
    -120,121,-122,123,-124,125,-126,127,-128,129,-130,131,-132,133,-134,135,
    -136,137,-138,139,-140,141,-142,143,-144,145,-146,147,-148,149,-150,151,
    -152,153,-154,155,-156,157,-158,159,-160,161,-162,163,-164,165,-166,167,
    -168,169,-170,171,-172,173,-174,175,-176,177,-178,179,-180,181,-182,183,
    -184,185,-186,187
    },
    {
     0,0,0,1,-3,6,-10,15,-21,28,-36,45,-55,66,-78,91,-105,120,-136,153,
    -171,190,-210,231,-253,276,-300,325,-351,378,-406,435,-465,496,-528,561,
    -595,630,-666,703,-741,780,-820,861,-903,946,-990,1035,-1081,1128,-1176,
    1225,-1275,1326,-1378,1431,-1485,1540,-1596,1653,-1711,1770,-1830,1891,
    -1953,2016,-2080,2145,-2211,2278,-2346,2415,-2485,2556,-2628,2701,-2775,
    2850,-2926,3003,-3081,3160,-3240,3321,-3403,3486,-3570,3655,-3741,3828,
    -3916,4005,-4095,4186,-4278,4371,-4465,4560,-4656,4753,-4851,4950,-5050,
    5151,-5253,5356,-5460,5565,-5671,5778,-5886,5995,-6105,6216,-6328,6441,
    -6555,6670,-6786,6903,-7021,7140,-7260,7381,-7503,7626,-7750,7875,-8001,
    8128,-8256,8385,-8515,8646,-8778,8911,-9045,9180,-9316,9453,-9591,9730,
    -9870,10011,-10153,10296,-10440,10585,-10731,10878,-11026,11175,-11325,
    11476,-11628,11781,-11935,12090,-12246,12403,-12561,12720,-12880,13041,
    -13203,13366,-13530,13695,-13861,14028,-14196,14365,-14535,14706,-14878,
    15051,-15225,15400,-15576,15753,-15931,16110,-16290,16471,-16653,16836,
    -17020,17205,-17391
    },
    {
     0,0,0,0,1,-4,10,-20,35,-56,84,-120,165,-220,286,-364,455,-560,680,
    -816,969,-1140,1330,-1540,1771,-2024,2300,-2600,2925,-3276,3654,-4060,
    4495,-4960,5456,-5984,6545,-7140,7770,-8436,9139,-9880,10660,-11480,12341,
    -13244,14190,-15180,16215,-17296,18424,-19600,20825,-22100,23426,-24804,
    26235,-27720,29260,-30856,32509,-34220,35990,-37820,39711,-41664,43680,
    -45760,47905,-50116,52394,-54740,57155,-59640,62196,-64824,67525,-70300,
    73150,-76076,79079,-82160,85320,-88560,91881,-95284,98770,-102340,105995,
    -109736,113564,-117480,121485,-125580,129766,-134044,138415,-142880,
    147440,-152096,156849,-161700,166650,-171700,176851,-182104,187460,
    -192920,198485,-204156,209934,-215820,221815,-227920,234136,-240464,
    246905,-253460,260130,-266916,273819,-280840,287980,-295240,302621,
    -310124,317750,-325500,333375,-341376,349504,-357760,366145,-374660,
    383306,-392084,400995,-410040,419220,-428536,437989,-447580,457310,
    -467180,477191,-487344,497640,-508080,518665,-529396,540274,-551300,
    562475,-573800,585276,-596904,608685,-620620,632710,-644956,657359,
    -669920,682640,-695520,708561,-721764,735130,-748660,762355,-776216,
    790244,-804440,818805,-833340,848046,-862924,877975,-893200,908600,
    -924176,939929,-955860,971970,-988260,1004731,-1021384,1038220,-1055240,
    1072445
    },
    {
     0,0,0,0,0,1,-5,15,-35,70,-126,210,-330,495,-715,1001,-1365,1820,
    -2380,3060,-3876,4845,-5985,7315,-8855,10626,-12650,14950,-17550,20475,
    -23751,27405,-31465,35960,-40920,46376,-52360,58905,-66045,73815,-82251,
    91390,-101270,111930,-123410,135751,-148995,163185,-178365,194580,-211876,
    230300,-249900,270725,-292825,316251,-341055,367290,-395010,424270,
    -455126,487635,-521855,557845,-595665,635376,-677040,720720,-766480,
    814385,-864501,916895,-971635,1028790,-1088430,1150626,-1215450,1282975,
    -1353275,1426425,-1502501,1581580,-1663740,1749060,-1837620,1929501,
    -2024785,2123555,-2225895,2331890,-2441626,2555190,-2672670,2794155,
    -2919735,3049501,-3183545,3321960,-3464840,3612280,-3764376,3921225,
    -4082925,4249575,-4421275,4598126,-4780230,4967690,-5160610,5359095,
    -5563251,5773185,-5989005,6210820,-6438740,6672876,-6913340,7160245,
    -7413705,7673835,-7940751,8214570,-8495410,8783390,-9078630,9381251,
    -9691375,10009125,-10334625,10668000,-11009376,11358880,-11716640,
    12082785,-12457445,12840751,-13232835,13633830,-14043870,14463090,
    -14891626,15329615,-15777195,16234505,-16701685,17178876,-17666220,
    18163860,-18671940,19190605,-19720001,20260275,-20811575,21374050,
    -21947850,22533126,-23130030,23738715,-24359335,24992045,-25637001,
    26294360,-26964280,27646920,-28342440,29051001,-29772765,30507895,
    -31256555,32018910,-32795126,33585370,-34389810,35208615,-36041955,
    36890001,-37752925,38630900,-39524100,40432700,-41356876,42296805,
    -43252665,44224635,-45212895,46217626,-47239010,48277230,-49332470
    },
    {
     0,0,0,0,0,0,1,-6,21,-56,126,-252,462,-792,1287,-2002,3003,-4368,6188,
    -8568,11628,-15504,20349,-26334,33649,-42504,53130,-65780,80730,-98280,
    118755,-142506,169911,-201376,237336,-278256,324632,-376992,435897,
    -501942,575757,-658008,749398,-850668,962598,-1086008,1221759,-1370754,
    1533939,-1712304,1906884,-2118760,2349060,-2598960,2869685,-3162510,
    3478761,-3819816,4187106,-4582116,5006386,-5461512,5949147,-6471002,
    7028847,-7624512,8259888,-8936928,9657648,-10424128,11238513,-12103014,
    13019909,-13991544,15020334,-16108764,17259390,-18474840,19757815,
    -21111090,22537515,-24040016,25621596,-27285336,29034396,-30872016,
    32801517,-34826302,36949857,-39175752,41507642,-43949268,46504458,
    -49177128,51971283,-54891018,57940519,-61124064,64446024,-67910864,
    71523144,-75287520,79208745,-83291670,87541245,-91962520,96560646,
    -101340876,106308566,-111469176,116828271,-122391522,128164707,-134153712,
    140364532,-146803272,153476148,-160389488,167549733,-174963438,182637273,
    -190578024,198792594,-207288004,216071394,-225150024,234531275,-244222650,
    254231775,-264566400,275234400,-286243776,297602656,-309319296,321402081,
    -333859526,346700277,-359933112,373566942,-387610812,402073902,-416965528,
    432295143,-448072338,464306843,-481008528,498187404,-515853624,534017484,
    -552689424,571880029,-591600030,611860305,-632671880,654045930,-675993780,
    698526906,-721656936,745395651,-769754986,794747031,-820384032,846678392,
    -873642672,901289592,-929632032,958683033,-988455798,1018963693,
    -1050220248,1082239158,-1115034284,1148619654,-1183009464,1218218079,
    -1254260034,1291150035,-1328902960,1367533860,-1407057960,1447490660,
    -1488847536,1531144341,-1574397006,1618621641,-1663834536,1710052162,
    -1757291172,1805568402
    }
};

static const Real max_exponent = logl(std::numeric_limits<Real>::max());

namespace ase {
    bool SbMomentsBy6Integrals::calculate(
        const Real a, const Real b,
        Real *pmean, Real *pvar,
        Real *pskew, Real *pkurt,
        Real *pdskewda, Real *pdskewdb,
        Real *pdkurtda, Real *pdkurtdb) const
    {
        // At a = 0 the derivatives w.r.t. a tend to infinity
        if (a <= 0.0L) throw std::domain_error(
            "In ase::SbMomentsBy6Integrals::calculate: invalid argument");

        assert(pmean);
        assert(pvar);
        assert(pskew);
        assert(pkurt);
        assert(pdskewda);
        assert(pdskewdb);
        assert(pdkurtda);
        assert(pdkurtdb);

        Real sum[6];
        bool status = integrate6(a, std::abs(b), sum);

        if (status)
        {
            // Calculate moments around the center
            const Real meansquared = sum[0]*sum[0];
            const Real mu2 = sum[1] - meansquared;
            const Real mu3 = sum[2] - (3*sum[1] - 2*meansquared)*sum[0];
            const Real mu4 = sum[3] - 4*sum[2]*sum[0] + 
                3*meansquared*(2*sum[1] - meansquared);

            if (mu2 > std::numeric_limits<Real>::min())
            {
                // Calculate skewness, kurtosis, and their
                // partial derivatives
                const Real SQRH2 = sqrtl(mu2);
                Real skew = mu3/mu2/SQRH2;
                if (b < 0.0L)
                    skew *= -1.0L;
                const Real kurt = mu4/mu2/mu2;
                if (my_inf_nan(kurt)) throw std::runtime_error(
                    "In ase::SbMomentsBy6Integrals::calculate: "
                    "Inf or NaN encountered in kurtosis calculation");

                const Real ONE = 1.0L, ONE5 = 1.5L, TWO = 2.0L;
                const Real THREE = 3.0L, FOUR = 4.0L, SIX = 6.0L;

                const Real G = b*SQRT2L;
                const Real D = a*SQRT2L;
                const Real H3 = std::abs(mu3);
                const Real W = G * D;
                const Real U = D * D;

                const Real* HMU = sum - 1;
                Real DERIV[5], DD[5];
                Real T, S, Y;

                for (int J=1; J<=2; ++J)
                {
                    for (int K=1; K<=4; ++K)
                    {
                        T = K;
                        if (J == 1)
                            S = HMU[K + 1] - HMU[K];
                        else
                            S = ((W - T) * (HMU[K] - HMU[K + 1]) + (T + ONE)*
                                 (HMU[K + 1] - HMU[K + 2])) / U;
                        DD[K] = T * S / D;
                    }
                    T = TWO * HMU[1] * DD[1];
                    S = HMU[1] * DD[2];
                    Y = DD[2] - T;
                    DERIV[J] = (DD[3] - THREE*(S + HMU[2]*DD[1] - T*HMU[1])
                                - ONE5 * H3 * Y / mu2) / mu2 / SQRH2;
                    DERIV[J + 2] = (DD[4] - FOUR*(DD[3]*HMU[1] + DD[1]*HMU[3])
                                    + SIX*(HMU[2]*T + HMU[1] * (S - T*HMU[1]))
                                    - TWO * mu4 * Y / mu2) / mu2 / mu2;
                }

                *pmean = sum[0];
                *pvar = mu2;
                *pskew = skew;
                *pkurt = kurt;
                *pdskewdb = DERIV[1]*SQRT2L;
                *pdskewda = DERIV[2]*SQRT2L;
                *pdkurtdb = DERIV[3]*SQRT2L;
                *pdkurtda = DERIV[4]*SQRT2L;

                if (b < 0.0L)
                {
                    *pdkurtdb *= -1.0L;
                    *pdskewda *= -1.0L;
                }
            }
            else
            {
#ifdef VERBOSE_CALC
                std::cout << "WARNING in SbMomentsBy6Integrals::calculate: "
                          << "zero second moment" 
                          << std::endl;
#endif
                status = false;
            }
        }

        if (!status)
        {
            *pmean = 0.0L;
            *pvar = 0.0L;
            *pskew = 0.0L;
            *pkurt = 0.0L;
            *pdskewdb = 0.0L;
            *pdskewda = 0.0L;
            *pdkurtdb = 0.0L;
            *pdkurtda = 0.0L;
        }

        return status;
    }

    void SbMomentsBy6Integrals::getParameters(
        const Real gamma, const Real delta,
        Real *p0, Real *p1) const
    {
        assert(p0);
        assert(p1);
        assert(delta >= 0.0L);
        *p0 = delta/SQRT2L;
        *p1 = gamma/SQRT2L;
    }

    void SbMomentsBy6Integrals::getGammaDelta(
        const Real p0, const Real p1,
        Real *gamma, Real *delta) const
    {
        assert(gamma);
        assert(delta);
        assert(p0 >= 0.0L);
        *gamma = p1*SQRT2L;
        *delta = p0*SQRT2L;
    }

    SbMomentsFunctor::SbMomentsFunctor(
        const Real a, const Real b, const unsigned n)
        : a_(a), b_(b), n_(n)
    {
        assert(a > 0.0L);
        assert(n && n < 7U);
    }

    Real SbMomentsFunctor::operator()(const Real& x) const
    {
        const Real exponent = -(x - b_)/a_;
        if (exponent >= max_exponent)
            return 0.0L;
        const Real denom = 1.0L + expl(exponent);
        Real result = 0.564189583547756286948079451561L; // 1/sqrt(Pi)
        assert(n_ && n_ < 7U);
        for (unsigned i = 0; i < n_; ++i)
            result /= denom;
        return result;
    }

    SbMomentsGaussFunctor::SbMomentsGaussFunctor(
        const Real a, const Real b, const unsigned n)
        : a_(a), b_(b), n_(n)
    {
        assert(a > 0.0L);
        assert(n && n < 7U);
    }

    Real SbMomentsGaussFunctor::operator()(const Real& x) const
    {
        const Real exponent = -(x - b_)/a_;
        if (exponent >= max_exponent)
            return 0.0L;
        const Real denom = 1.0L + expl(exponent);
        Real result = 0.564189583547756286948079451561L; // 1/sqrt(Pi)
        assert(n_ && n_ < 7U);
        for (unsigned i = 0; i < n_; ++i)
            result /= denom;
        return result*expl(-x*x);
    }

    SbMomentsInvErfFunctor::SbMomentsInvErfFunctor(
        const Real a, const Real b, const unsigned n)
        : a_(a), b_(b), n_(n)
    {
        assert(a > 0.0L);
        assert(n && n < 7U);
    }

    Real SbMomentsInvErfFunctor::operator()(const Real& input) const
    {
        const Real inp = input*2.0L - 1.0L;
        if (inp <= -1.0L)
            return 0.0L;
        else if (inp >= 1.0L)
            return 1.0L;
        const Real x = inverseErf(inp);
        const Real exponent = -(x - b_)/a_;
        if (exponent >= max_exponent)
            return 0.0L;
        const Real denom = 1.0L + expl(-(x - b_)/a_);
        Real result = 1.0L;
        assert(n_ && n_ < 7U);
        for (unsigned i = 0; i < n_; ++i)
            result /= denom;
        return result;
    }

    SbMomentsGaussHermite::SbMomentsGaussHermite(const unsigned npoints)
        : SbMomentsBy6Integrals(),
          quad_(npoints)
    {
        assert(quad_.npoints());
    }

    SbMomentsMultiZone::SbMomentsMultiZone(const unsigned npoints)
        : SbMomentsBy6Integrals(),
          quad_(npoints)
    {
        assert(quad_.npoints());
    }

    bool SbMomentsGaussHermite::integrate6(
        const Real a, const Real b, Real *results) const
    {
        for (unsigned n=1U; n<=6U; ++n)
            results[n-1U] = quad_.integrate(SbMomentsFunctor(a, b, n));
        return true;
    }

    void SbMoments0SkewBigKurt::getParameters(
#ifdef NDEBUG
        const Real,
#else
        const Real gamma,
#endif
        const Real delta,
        Real *p0, Real *p1) const
    {
        assert(p0);
        assert(p1);
        assert(delta > 0.0L);
        assert(gamma == 0.0L);
        const Real a = delta/SQRT2L;
        *p0 = 1.0L/a/a;
        *p1 = 0.0L;
    }

    void SbMoments0SkewBigKurt::getGammaDelta(
        const Real p0,
#ifdef NDEBUG
        const Real,
#else
        const Real p1,
#endif
        Real *gamma, Real *delta) const
    {
        assert(gamma);
        assert(delta);
        assert(p0 > 0.0L);
        assert(p1 == 0.0L);
        *gamma = 0.0L;
        *delta = sqrtl(2.0L/p0);
    }

    bool SbMoments0SkewBigKurt::calculate(
        const Real o,
#ifdef NDEBUG
        const Real,
#else
        const Real p1,
#endif
        Real *mean, Real *var,
        Real *skew, Real *kurt,
        Real *dskewdo, Real *dskewdp1,
        Real *dkurtdo, Real *dkurtdp1) const
    {
        static const Real ocoeffs[19] = {
            0.L,-1.L,0.75L,-0.666666666666666666666666666667L,0.666015625L,
            -0.730989583333333333333333333333L,0.870552571614583333333333333333L,
            -1.1161835201202876984126984127L,1.53234282448178245907738095238L,
            -2.24311088195343286692570546737L,3.48941642193251816683976107804L,
            -5.75180598073301358121278979026L,10.0203665926068479484026298627L,
            -18.4062217128730021663377100762L,35.5707483799407807007176541246L,
            -72.1728020413790148936248797921L,153.448812509861417299856889262L,
            -341.246672090303143837451790974L,792.390977024097729233967929523L
        };
        static const unsigned maxdeg = sizeof(ocoeffs)/sizeof(ocoeffs[0]) - 1U;

        static const Real varcoeffs[19] = {
            0.L, 0.03125L, -0.0078125L,
            0.00276692708333333333333333333333L, 
            -0.00126139322916666666666666666667L, 
            0.000702921549479166666666666666667L, 
            -0.000462934705946180555555555555556L, 
            0.000351788127233111669146825396825L, 
            -0.000302970504003857809399801587302L, 
            0.000291624635037501232544160604056L, 
            -0.000310251408534180340102530450838L, 
            0.000361502959292694981212472235218L, 
            -0.000457848846570355307491399942284L, 
            0.000626262125360912249491673548415L, 
            -0.000920077487273003610733353602142L, 
            0.00144496177082410849596712187139L,
            -0.00241568640947414568470574648008L,
            0.00428330361054101555720953273142L,
            -0.00802880374681102119742268410718L
        };

        assert(o > 0.0L);
        assert(p1 == 0.0L);
        assert(mean);
        assert(var);
        assert(skew);
        assert(kurt);
        assert(dskewdo);
        assert(dskewdp1);
        assert(dkurtdo);
        assert(dkurtdp1);

        polyAndDeriv(ocoeffs, maxdeg, o, kurt, dkurtdo);
        *kurt += 3.0L;

        *mean = 0.5L;
        *var = polySeriesSum(varcoeffs, maxdeg, o);
        *skew = 0.0L;
        *dskewdo = 0.0L;
        *dskewdp1 = 0.0L;
        *dkurtdp1 = 0.0L;

        return true;
    }

    void SbMomentsBigDelta::getParameters(
        const Real gamma, const Real delta,
        Real *p0, Real *p1) const
    {
        assert(p0);
        assert(p1);
        assert(delta > 0.0L);
        const Real a = delta/SQRT2L;
        const Real absb = std::abs(gamma/SQRT2L);
        *p0 = 1.0L/a/a;
        *p1 = 1.0L/(1.0L + expl(absb/a));
    }

    void SbMomentsBigDelta::getGammaDelta(
        const Real /* o */,
        const Real /* f0 */,
#ifdef NDEBUG
        Real *,
        Real *
#else
        Real *gamma,
        Real *delta
#endif
        ) const
    {
        assert(gamma);
        assert(delta);
        assert(!"Function not implemented");
    }

    bool SbMomentsBigDelta::calculate(
        const Real o, const Real f0,
        Real *mean, Real *var,
        Real *skew, Real *kurt,
        Real *dskewdo, Real *dskewdf0,
        Real *dkurtdo, Real *dkurtdf0) const
    {
    static const Real meancoeffs[19][37] = {
        {0L,0.5L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L},{0L,0.125L,-0.1875L,0.0625L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},
        {0L,0.015625L,-0.1171875L,0.1953125L,-0.1171875L,0.0234375L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},
        {0L,0.00130208333333333333333333333333L,-0.041015625L,
         0.195963541666666666666666666667L,-0.341796875L,0.2734375L,-0.1025390625L,
         0.0146484375L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},
        {0L,0.0000813802083333333333333333333333L,-0.0103759765625L,
         0.123087565104166666666666666667L,-0.4742431640625L,0.8485107421875L,
         -0.8074951171875L,0.4229736328125L,-0.1153564453125L,0.0128173828125L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},
        {0L,4.06901041666666666666666666667e-6L,-0.002081298828125L,
         0.0579854329427083333333333333333L,-0.444793701171875L,1.50592041015625L,
         -2.7387542724609375L,2.9290924072265625L,-1.90338134765625L,
         0.740203857421875L,-0.1586151123046875L,0.0144195556640625L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},
        {0L,1.69542100694444444444444444444e-7L,-0.000347137451171875L,
         0.0221782260470920138888888888889L,-0.322027842203776041666666666667L,
         1.90951054890950520833333333333L,-5.92633056640625L,10.90130615234375L,
         -12.681278228759765625L,9.59973907470703125L,-4.7254085540771484375L,
         1.4605808258056640625L,-0.2577495574951171875L,0.0198268890380859375L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},
        {0L,6.0550750248015873015873015873e-9L,
         -0.0000496001470656622023809523809524L,0.00719070737324063740079365079365L,
         -0.19235134124755859375L,1.91431427001953125L,-9.552484989166259765625L,
         27.843293666839599609375L,-51.648101806640625L,64.0187168121337890625L,
         -54.34219837188720703125L,31.74615383148193359375L,
         -12.565290927886962890625L,3.22186946868896484375L,
         -0.4832804203033447265625L,0.0322186946868896484375L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},{0L,1.89221094525049603174603174603e-10L,
         -6.20030221484956287202380952381e-6L,0.00203013656631348625062003968254L,
         -0.0985374464875175839378720238095L,1.60442978172075180780319940476L,
         -12.4217143356800079345703125L,54.7258019149303436279296875L,
         -152.1110164225101470947265625L,283.9810342490673065185546875L,
         -369.9214361608028411865234375L,343.3636428415775299072265625L,
         -228.7406502664089202880859375L,108.6535204946994781494140625L,
         -35.9439812600612640380859375L,7.8734435141086578369140625L,
         -1.0269708931446075439453125L,0.0604100525379180908203125L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},{0L,5.25614151458471119929453262787e-12L,
         -6.88930352528889973958333333333e-7L,0.000508395297291838092568479938272L,
         -0.0443868021722193117494936342593L,1.16362524970814033790870949074L,
         -13.6610061753955152299669053819L,88.279010452389244049314468626L,
         -353.85104589164257049560546875L,947.560392158726851145426432292L,
         -1778.07000944390892982482910156L,2410.50902364775538444519042969L,
         -2404.08316534012556076049804687L,1777.9039643704891204833984375L,
         -973.183292616158723831176757813L,389.219115804880857467651367188L,
         -110.5705328285694122314453125L,21.138484217226505279541015625L,
         -2.4390558712184429168701171875L,0.1283713616430759429931640625L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},{0L,1.31403537864617779982363315697e-13L,
         -6.88932323581957943225033068783e-8L,0.000114475058250431451006961667769L,
         -0.017888200469315052032470703125L,0.747277971692383289337158203125L,
         -13.1004462673018376032511393229L,121.679448559507727622985839844L,
         -685.613888766430318355560302734L,2551.25422579555047882927788628L,
         -6629.81833250029012560844421387L,12492.2262919140048325061798096L,
         -17500.35731400316581130027771L,18515.6260640001855790615081787L,
         -14913.1328637013211846351623535L,9150.62849590089172124862670898L,
         -4247.29059227742254734039306641L,1466.31973884534090757369995117L,
         -364.94373473105952143669128418L,61.8910427321679890155792236328L,
         -6.40252166194841265678405761719L,0.304881983902305364608764648437L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},{0L,2.98644404237767681778098444765e-15L,
         -6.26302560313840850492461820587e-9L,0.000023423181601849450158331282192L,
         -0.00653212043092088409201808707424L,0.431915461953000101462873832259L,
         -11.1876284283353015780448913574L,147.245794741553254425525665283L,
         -1145.56851400528103113174438477L,5794.92838648613542318344116211L,
         -20305.7981716669164597988128662L,51479.3983253301121294498443604L,
         -97332.683711075806058943271637L,140146.315217037918046116828918L,
         -155795.00797190034063532948494L,134743.599291388120036572217941L,
         -90858.3407332794740796089172363L,47592.9279691271949559450149536L,
         -19165.6284689594758674502372742L,5819.14522985054645687341690063L,
         -1288.50748446711804717779159546L,196.343997633084654808044433594L,
         -18.4072497781016863882541656494L,0.800315207743551582098007202148L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},{0L,6.22175842162016003704371759927e-17L,
         -5.21918893587910366379452072811e-10L,4.39249894887820761434781252557e-6L,
         -0.00218249749366858269597009643829L,0.227406978877632999970388465993L,
         -8.63885331720693675042302520187L,159.470850354288202690739164907L,
         -1690.92206705764692742377519608L,11444.7770705024546865994731585L,
         -53055.5505721531517338007688522L,176906.289460123080061748623848L,
         -439301.245672291988739743828773L,832988.541105764015810564160347L,
         -1.22765571974613703787326812744e6L,1.4233407041923608630895614624e6L,
         -1.3076429162810843990882858634e6L,954699.460294725577114149928093L,
         -553060.97634627531078876927495L,252577.597870370482269208878279L,
         -89792.8653238022889127023518085L,24326.970175489805114921182394L,
         -4851.07728527054860023781657219L,671.097648159957316238433122635L,
         -57.5226555565677699632942676544L,2.30090622226271079853177070618L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L},{0L,1.19649200415772308404686876909e-18L,
         -4.0147608993808034419619400902e-11L,7.60290387200056093712890592129e-7L,
         -0.000672424652318055474948802781025L,0.110086011621609733123269546714L,
         -6.10121776588563410438258539547L,156.78254805909182139639413417L,
         -2243.88345952154243908201654752L,20081.5814456842087599431612977L,
         -121433.078729813705649576149881L,523730.794593024593268637545407L,
         -1.67494331988941976305795833468e6L,4.08669534326734574278816580772e6L,
         -7.76812997337545830305316485465e6L,1.16801297725396014539001043886e7L,
         -1.40410620303721865639090538025e7L,1.35870445418254543255898170173e7L,
         -1.06179723861728422889427747577e7L,6.69969858975115248540532775223e6L,
         -3.39968960804037919842812698334e6L,1.3757334697660603524127509445e6L,
         -437688.448063535247456457000226L,107039.595526050220541947055608L,
         -19413.8962503416223626118153334L,2459.09352504327216593082994223L,
         -194.138962503416223626118153334L,7.1903319445709712454117834568L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L},{0L,2.13659286456736265008369423052e-20L,
         -2.86768638874946685562611124425e-12L,1.22193111122251288028396290852e-7L,
         -0.00019226388475671252997994431209L,0.0493617181277344629785553260105L,
         -3.9763315538346193874292451926L,141.448535586646447348083177256L,
         -2712.56585658969349790456728986L,31810.4844289413050162950483612L,
         -248226.303372477824604218421016L,1.36738812490918409956802428323e6L,
         -5.54969987937792738989628560375e6L,1.71281451288779322601385501912e7L,
         -4.11623445892981495717322104611e7L,7.84090039559873677490031695925e7L,
         -1.19963729919516940344692557119e8L,1.48826857767110529289311671164e8L,
         -1.50663589685328254461182950763e8L,1.24889016124024460452801577048e8L,
         -8.48205501738702087664023565594e7L,4.70900458123169209443403815385e7L,
         -2.12491478447565557985399209429e7L,7.71744542111983008680908824317e6L,
         -2.22151596967971656226836785208e6L,495067.296981211597994843032211L,
         -82339.1874717614058454273617826L,9617.96776735674541214393684641L,
         -703.753739074883810644678305835L,24.2673703129270279532647691667L,0L,0L,0L,0L,
         0L,0L,0L},{0L,3.56098810761227108347282371753e-22L,
         -1.91179093117446006516914745471e-13L,1.83292056422036003759027930839e-8L,
         -0.0000512917531345952283554601239656L,0.0206250678283052627792897705511L,
         -2.408439075099712987366883302L,118.10708978718640141063592355L,
         -3017.86690702257643092057800719L,46051.3999415092985740047109574L,
         -459854.215689014642037955849128L,3.2038910144628771165673418511e6L,
         -1.63159600629029412152839367558e7L,6.28705886134843789288933770703e7L,
         -1.88170788415270893265329732458e8L,4.4628854075147713374039426526e8L,
         -8.51697189501692543040007876698e8L,1.32309878051344428800916830369e9L,
         -1.68747544797148148087387653504e9L,1.77735274675285157416112724604e9L,
         -1.55135562435991186434591782017e9L,1.12345987177168119122825373779e9L,
         -6.74198350156327245555587523995e8L,3.33995951704158160087843043584e8L,
         -1.35648160850208153505036534625e8L,4.46779319816577856556705228286e7L,
         -1.17415681334731764735579417902e7L,2.40319390716489267845190624939e6L,
         -369060.189999853651698913381551L,39996.6708374225632383058837149L,
         -2727.04573891517476624812843511L,87.9692173843604763305847882293L,0L,0L,0L,0L,
         0L},{0L,5.56404391814417356792628705864e-24L,
         -1.19486933281864412845234319438e-14L,2.57755947930153388535254848348e-9L,
         -0.0000128259454234302411119918433211L,0.00807109378518236265942880740185L,
         -1.36361332074427711324656320098L,91.8958001798396057046767715002L,
         -3115.14676364938632248973016752L,61516.1225655751404908864030464L,
         -780892.779191045556369211845372L,6.8279947171256035583835755334e6L,
         -4.3241194583109771764104678482e7L,2.0591018575924337759566083624e8L,
         -7.58618519898637785772210762048e8L,2.2105344296764982135268014692e9L,
         -5.18243019732739760170802334471e9L,9.9062643444050134159630527364e9L,
         -1.55981147067441370064466266143e10L,2.03870425384618943661854562066e10L,
         -2.22395405190227800090590815074e10L,2.03179706309436901446686452033e10L,
         -1.55694761584119873506997233648e10L,1.00026821401329817316148140804e10L,
         -5.37412881000926216420565673104e9L,2.40275417818175525606059217409e9L,
         -8.86979778501030135583915736674e8L,2.67219261707900242529989398577e8L,
         -6.45993730070993835592485510233e7L,1.22242325038800047807274751221e7L,
         -1.7436048693188898661698971182e6L,176235.330877393169268785300119L,
         -11249.0636730250959107735297948L,340.880717364396845781016054389L,0L,0L,0L},
        {0L,8.1824175266826081881268927333e-26L,
         -7.02864313545468103166323354812e-16L,3.41148456723241892388254677067e-10L,
         -3.01826751716675829249919642388e-6L,0.00297070910852734189309320138652L,
         -0.725177922876670708841413638208L,67.0019950224199463921429924177L,
         -3003.06235768926645365481397262L,76410.6242491509177083965554846L,
         -1.22654380941480763386318804619e6L,1.33759590491909302153562474614e7L,
         -1.04587469163411025543628666649e8L,6.10445947153584433760427074844e8L,
         -2.74283638367090440997340983209e9L,9.71674587748060503288076004876e9L,
         -2.76541008486805603593422997477e10L,6.41721181383539961305271837055e10L,
         -1.22842765600939042915497952935e11L,1.95760643765845956112659557169e11L,
         -2.61512562875527464416860745633e11L,2.94341260326461575327951680769e11L,
         -2.80063852279998086455996514355e11L,2.25662281741445254210732768163e11L,
         -1.53992450372740118123290886665e11L,8.88541064262852156846123619083e10L,
         -4.31981388288081569415323979211e10L,1.75938156342177098431106829768e10L,
         -5.95178178503842111152860594459e9L,1.65198999497384614616235509743e9L,
         -3.69716882498492938705775268105e8L,6.50519290881450015150144761122e7L,
         -8.66177902822932385129561794201e6L,820244.226158079910160569880873L,
         -49214.6535694847946096341928524L,1406.13295912813698884669122435L,0L},
        {0L,1.13644687870591780390651287963e-27L,
         -3.90480174208973427161879519732e-17L,4.26436059004270111075957716477e-11L,
         -6.70775865757194766530214189041e-7L,0.00103225079933247109925445413005L,
         -0.363723816880308795196422451522L,45.9916941029039095267224994357L,
         -2718.35013887472646197136716935L,88811.2060060334490621963659206L,
         -1.79502145051696630064656245506e6L,2.42916303331425451841969390302e7L,
         -2.3314422686128816056189348573e8L,1.65687350127903783103004488628e9L,
         -9.0112236975322828121658999545e9L,3.84838735960252474910954533165e10L,
         -1.31702668665544258384166798096e11L,3.67075409981733459980021789267e11L,
         -8.44065834146872803581784031751e11L,1.61785278308565516877105900026e12L,
         -2.60607500172690556494110748834e12L,3.55030427417626640223947576194e12L,
         -4.10978892559509526207003993203e12L,4.05560235399347089199408789018e12L,
         -3.41803044457457258161944681912e12L,2.46142739188776242139526235497e12L,
         -1.5131291979297521779154154821e12L,7.92058354787012196626291928719e11L,
         -3.51539977671286156294264513972e11L,1.31445508404177941892642878657e11L,
         -4.10310324626606737294083268597e10L,1.05571343784255544744725766049e10L,
         -2.1993339675052781923920985907e9L,3.61588535632008419489387407442e8L,
         -4.51441915971753230554623648185e7L,4.02124731873998675956219384098e6L,
         -227617.772758867175069558141942L}
    };
    static const Real varcoeffs[19][37] = {
        {0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L},{0L,0L,0.125L,-0.125L,0.03125L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},
        {0L,0L,0.09375L,-0.34375L,0.3984375L,-0.1875L,0.03125L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},
        {0L,0L,0.0364583333333333333333333333333L,
         -0.356770833333333333333333333333L,1.02864583333333333333333333333L,
         -1.318359375L,0.8486328125L,-0.26953125L,0.03369140625L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},
        {0L,0L,0.009765625L,-0.231770833333333333333333333333L,1.39990234375L,
         -3.65478515625L,5.02286783854166666666666666667L,-3.9306640625L,
         1.7657470703125L,-0.4248046875L,0.04248046875L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},{0L,0L,0.00201822916666666666666666666667L,
         -0.111759440104166666666666666667L,1.31245524088541666666666666667L,
         -6.229522705078125L,15.3724212646484375L,-22.22406005859375L,
         19.91118621826171875L,-11.21978759765625L,3.8763427734375L,
         -0.751190185546875L,0.06259918212890625L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L},{0L,0L,0.000341796875L,
         -0.0433844672309027777777777777778L,0.953392537434895833333333333333L,
         -7.76216074625651041666666666667L,31.6900574578179253472222222222L,
         -75.3601430257161458333333333333L,113.191380182902018229166666667L,
         -112.0575714111328125L,74.2905120849609375L,-32.70114898681640625L,
         9.1818523406982421875L,-1.490020751953125L,0.1064300537109375L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},
        {0L,0L,0.0000492156498015873015873015873016L,
         -0.0141948760501922123015873015873L,0.571469594561864459325396825397L,
         -7.71698284149169921875L,49.762047672271728515625L,
         -182.9534488677978515625L,423.7363819599151611328125L,
         -655.688915252685546875L,701.00915622711181640625L,
         -525.76217365264892578125L,276.3229248523712158203125L,
         -99.775764942169189453125L,23.5981786251068115234375L,
         -3.2942676544189453125L,0.20589172840118408203125L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L},{0L,0L,6.17617652529761904761904761905e-6L,
         -0.00402954041011749751984126984127L,0.293585609254382905505952380952L,
         -6.4407040618714832124255952381L,63.7300251487701658218625992063L,
         -348.824205875396728515625L,1186.647945225238800048828125L,
         -2694.28946399688720703125L,4269.6773281574249267578125L,
         -4852.6603367328643798828125L,4011.285778820514678955078125L,
         -2417.48377096652984619140625L,1051.809332549571990966796875L,
         -321.900808811187744140625L,65.7670582830905914306640625L,
         -8.055574893951416015625L,0.4475319385528564453125L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L},{0L,0L,6.87587408371913580246913580247e-7L,
         -0.00101234791981059617676642416226L,0.132528479079300343885203097443L,
         -4.66118966575179781232561383929L,69.4383811609100097070926080936L,
         -551.939295116161543225485181052L,2672.76559773870995120396689763L,
         -8561.85488981505235036214192708L,19139.7216060807307561238606771L,
         -30927.9363739416003227233886719L,36947.1820323783904314041137695L,
         -33047.3339365795254707336425781L,22223.1829977594316005706787109L,
         -11184.3174554407596588134765625L,4149.99322288669645786285400391L,
         -1101.9972212612628936767578125L,198.167045228183269500732421875L,
         -21.622891165316104888916015625L,1.08114455826580524444580078125L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},{0L,0L,6.88260194485780423280423280423e-8L,
         -0.000228377458174602905488729056437L,0.0534911308441527936824415095899L,
         -2.9902016383232105345953078497L,66.1998807715806564746500112813L,
         -751.155635278727169390077944155L,5067.8221271348343521514266887L,
         -22307.4596401377921066586933439L,68107.9132764380366083175416977L,
         -150358.057820359244942665100098L,246939.991142885293811559677124L,
         -307476.99259200878441333770752L,293597.524055211804807186126709L,
         -216038.005327843129634857177734L,122312.308102918323129415512085L,
         -52814.2493655905127525329589844L,17079.3350669089704751968383789L,
         -4004.97204693965613842010498047L,643.128057417925447225570678711L,
         -63.2684935815632343292236328125L,2.87584061734378337860107421875L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},{0L,0L,6.25996897766103495270161936829e-9L,
         -0.0000467797180559173768694744443442L,0.019553737658786314008173622228L,
         -1.72741880394030539762406122117L,56.3220891723128173638273168493L,
         -901.209731678165909316804673937L,8341.91376226235243920532483903L,
         -49520.5811768089021955217633929L,201895.166053194480962933055938L,
         -592650.270112643087105382056463L,1.29493997219509837635245824617e6L,
         -2.15612946263883227948099374771e6L,2.78030081958833913085982203484e6L,
         -2.80521580279043549671769142151e6L,2.22605465388374324538744986057e6L,
         -1.38960495296217966824769973755e6L,678911.501507498323917388916016L,
         -256615.144903259351849555969238L,73527.8725331911118701100349426L,
         -15436.045801985892467200756073L,2239.14511196926468983292579651L,
         -200.544347794493660330772399902L,8.3560144914372358471155166626L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L},{0L,0L,5.21791503084227693602693602694e-10L,
         -8.77792502412334881692266268004e-6L,0.00653800378068048176674462863224L,
         -0.909312714452086503624782283967L,43.3852628514798161400544077013L,
         -970.288775030648741522899170191L,12183.6584683058751433696827771L,
         -96207.4435527823451492521497938L,515234.717838008621345377630658L,
         -1.97228044891148689591015378634e6L,5.6026360624155497602057746715e6L,
         -1.21363933059712262106283257405e7L,2.04465451535879066395517882137e7L,
         -2.7167249253822183818556368351e7L,2.87337442316527192378998734057e7L,
         -2.4316556813545076991431415081e7L,1.64863239976152032031677663326e7L,
         -8.92977636681924050208181142807e6L,3.83533101082151726586744189262e6L,
         -1.2887503214373801893088966608e6L,331455.710904865336488001048565L,
         -62985.5788474131259135901927948L,8331.28191730083926813676953316L,
         -684.825935839035082608461380005L,26.339459070732118561863899231L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L},{0L,0L,4.01427087608050064647286869509e-11L,
         -1.51989064614568082170944423074e-6L,0.00201534203563759843580751027824L,
         -0.440168399592257996155607579934L,30.5926656898878179533683039524L,
         -950.024056279430982558000268358L,16045.7116149736389684910660214L,
         -166796.152429372400715860917612L,1.15895351081197478666177226437e6L,
         -5.70179819116662300584721378982e6L,2.07030969942266226149984976035e7L,
         -5.7197892449642828118360032224e7L,1.22993835411452036501739510439e8L,
         -2.09331595904647331869152064125e8L,2.85446715858638424183178964692e8L,
         -3.14479430894722245284356176853e8L,2.81334758970483623979816911742e8L,
         -2.04757497688241235100576886907e8L,1.21080113748925709954164631199e8L,
         -5.78913990858731841308326693252e7L,2.21765146632996209655175334774e7L,
         -6.7062413118122571358981076628e6L,1.56448530563212536208084202372e6L,
         -271538.645633088435715762898326L,33007.5662774831471324432641268L,
         -2507.08580163022816122975200415L,89.5387786296510057582054287195L,0L,0L,0L,0L,
         0L,0L,0L,0L},{0L,0L,2.86751136974496582011462963844e-12L,
         -2.44323886466255260955007419934e-7L,0.000576429147482515277333699602953L,
         -0.197372282679828950172527772656L,19.9176283748309083760655280016L,
         -854.643463261079095695031150108L,19290.5695822951518477094833981L,
         -261875.028482556511761663813536L,2.33838746995558536395664991405e6L,
         -1.46218025178269136276867357083e7L,6.69900411642232090384065183268e7L,
         -2.3254932080344562348909676075e8L,6.27313935361877476527297403663e8L,
         -1.3404072804628745493755559437e9L,2.30172808141581079705565571203e9L,
         -3.21066385284160685685856151395e9L,3.66570721836012394692230979369e9L,
         -3.44225635366738921463820588542e9L,2.6645938146201618172437974863e9L,
         -1.69973274509648975350273758522e9L,8.90731448309390247633245962788e8L,
         -3.81054067108570516279542061966e8L,1.31706136211956545596990508784e8L,
         -3.62023620895928814888975466602e7L,7.72701676359244420382310636342e6L,
         -1.23418714365893657713968423195e6L,138781.804163323201350976887625L,
         -9796.93364377135367249138653278L,326.564454792378455749712884426L,0L,0L,0L,0L,
         0L,0L},{0L,0L,1.9117325897257989995258513777e-13L,
         -3.66531688326958284438241200111e-8L,0.000153812170520876989468260756875L,
         -0.0824733444080024050434258435858L,12.0559483014173675705332740475L,
         -712.164761501674567127977298079L,21375.2005841031473771119015729L,
         -376590.836998409958518705493289L,4.2892921754515932992462178317e6L,
         -3.37916796408455176669584829559e7L,1.93384420280534853393702346752e8L,
         -8.33797368914608683934644280574e8L,2.78448425459835520496657317207e9L,
         -7.3570526268231073565497808886e9L,1.56336392349168690737384650902e10L,
         -2.70574023224423168618295676424e10L,3.85048125298853813612936392019e10L,
         -4.53677837009358257719236462435e10L,4.44613728263775430378968849254e10L,
         -3.63318282917660680268937767323e10L,2.47631961794556873775135841242e10L,
         -1.40514183277101910066505752184e10L,6.60877684586641384533365339848e9L,
         -2.55740333597376379753995934152e9L,8.05133436440248039697564763628e8L,
         -2.02827301883717225881298418244e8L,3.98954938723564887364858577712e7L,
         -5.90155982949559353656354687701e6L,617352.282067675075083457159053L,
         -40706.4794597892216643231222406L,1272.07748311841317701009757002L,0L,0L,0L,0L},
        {0L,0L,1.19485110083773534953160449192e-14L,
         -5.15470640461631130845144789372e-9L,0.0000384675973690769374844983347111L,
         -0.0322757483157010796200762180768L,6.82291599148941843383502362372L,
         -553.318992521368032772662858423L,21998.5356266570662013567048003L,
         -500524.036015539967483267435385L,7.22854156997041589703963526234e6L,
         -7.12501588995372819687163103351e7L,5.05254653590967881107338440933e8L,
         -2.68102653388528152379217966895e9L,1.09692070876160280073783463589e10L,
         -3.5416567749854548058038433499e10L,9.18891758728025988989209769067e10L,
         -1.9431913972479017004258249699e11L,3.38664587227572184884763618129e11L,
         -4.90590715492137633008972272819e11L,5.94433507263126387564366226002e11L,
         -6.05082167012556221192307532419e11L,5.18751201701960268063519748694e11L,
         -3.74866235683517129189682748347e11L,2.28093278574761002458591541142e11L,
         -1.16505876393678660864929241825e11L,4.96886521553204188812301822509e10L,
         -1.75499656894124538698758186683e10L,5.07243480734316330509825476724e9L,
         -1.17928370463179018330723835106e9L,2.15083529825541683111378432613e8L,
         -2.96275401695758953977133387525e7L,2.89728969402609515015889485312e6L,
         -179220.823975168038089123001555L,5271.20070515200112026832357515L,0L,0L},
        {0L,0L,7.02858951157229904085634224912e-16L,
         -6.82266402870394521173966743667e-10L,9.05324568516602611581851648841e-6L,
         -0.0118803275982029747784388056265L,3.62746673069030167182597691494L,
         -403.017797818349891917012174766L,21160.1663814107738971846863005L,
         -619328.551688685076223744690248L,1.1287053426550236554403643549e7L,
         -1.38414318254876032738420373746e8L,1.20836438137715191759912143483e9L,
         -7.83301126877810718528200728696e9L,3.89368587894832855291423682269e10L,
         -1.52184529769756186821474034389e11L,4.76999386606213882020860274509e11L,
         -1.21783814965408540305146527898e12L,2.5643440444834266295055643541e12L,
         -4.49716090942928417207385937582e12L,6.61903507087651229565527618013e12L,
         -8.22344157688875725594957377984e12L,8.65967795159753370531385105768e12L,
         -7.74918541979653565786669741566e12L,5.89908418379388020421959971451e12L,
         -3.81852279157634977010629417915e12L,2.0974416704907748910603978576e12L,
         -9.7380529155865612460955065055e11L,3.7983641597809560601651545475e11L,
         -1.23374177083033823571310005907e11L,3.29556337768864982178737166318e10L,
         -7.11291597061426411078537412891e9L,1.20927303804641175546206455227e9L,
         -1.55852965701245421249243605644e8L,1.43083520493545930279410960395e7L,
         -833523.539437338004287614268151L,23153.4316510371667857670630042L},
        {0L,0L,3.90478684651002804134825172407e-17L,
         -8.5285083248620035712477467452e-11L,2.01210489516128921631735781253e-6L,
         -0.00412833160389634419793098691857L,1.81909085950230434138509720513L,
         -276.439846425744765439957630532L,19122.5039793556127895646009685L,
         -717723.512699996081530850142126L,1.64425257409286258104244268967e7L,
         -2.49711936099118457731395430313e8L,2.66957151690804650240845906999e9L,
         -2.10128903716883265302986264782e10L,1.2604145416469683822300492132e11L,
         -5.91803114085682136983069779681e11L,2.22173755333567764574359462036e12L,
         -6.78296753697587632328921803954e12L,1.70714019913666498830852419256e13L,
         -3.58090439581775287197763763014e13L,6.31525286759439735769179728778e13L,
         -9.42893006750668120353710080449e13L,1.198153619230555413227268957e14L,
         -1.30084228767228266587056092095e14L,1.20978153029578317789450082898e14L,
         -9.64968177502725506351193383858e13L,6.6014413611261569914032340155e13L,
         -3.86806346878987662129291120489e13L,1.93570709667603717604059714065e13L,
         -8.23550589683979649376973386776e12L,2.95903043904256639264278035378e12L,
         -8.89530383463447420866734716149e11L,2.20856132191121105993735095757e11L,
         -4.44799605083222730868072636312e10L,7.08150528877068989027154521931e9L,
         -8.57470595734067846054524131283e8L,7.41823474298092127239244442105e7L}
    };
    static const Real skewcoeffs[19][37] = {
        {3.L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L},{0.875L,-5.5L,2.75L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},
        {0.2265625L,-6.65625L,21.421875L,-18.09375L,4.5234375L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},
        {0.0458984375L,-4.984375L,44.22265625L,-115.55859375L,121.1748046875L,
         -55.37109375L,9.228515625L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L},{0.00748494466145833333333333333333L,
         -2.789306640625L,56.2093505859375L,-316.079345703125L,750.49566650390625L,
         -885.738525390625L,550.0006103515625L,-172.447509765625L,21.555938720703125L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},
        {0.00101292928059895833333333333333L,-1.25926615397135416666666666667L,
         53.0231572469075520833333333333L,-561.101531982421875L,
         2466.10942840576171875L,-5547.3072509765625L,7063.207489013671875L,
         -5309.669952392578125L,2337.969532012939453125L,-558.0869293212890625L,
         55.80869293212890625L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},
        {0.000116616960555788070436507936508L,
         -0.47869396209716796875L,40.296621799468994140625L,
         -749.90840244293212890625L,5548.7085173130035400390625L,
         -20891.8238697052001953125L,45407.05202579498291015625L,
         -61001.2893276214599609375L,52338.2821061611175537109375L,
         -28762.23290920257568359375L,9805.152922153472900390625L,
         -1889.70808124542236328125L,157.4756734371185302734375L,0L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},
        {0.000011654474117137767650462962963L,-0.15753246463795818349041005291L,
         25.8344759042931612206514550265L,-812.70945503711700439453125L,
         9594.8358717024326324462890625L,-56374.74516761302947998046875L,
         190884.837172567844390869140625L,-405249.4096825122833251953125L,
         566837.089881569147109985351563L,-536225.750314235687255859375L,
         345394.98007428646087646484375L,-149376.81729805469512939453125L,
         41532.4535305202007293701171875L,-6711.78125131130218505859375L,
         479.412946522235870361328125L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},
        {1.02800795089000116580377810847e-6L,
         -0.045768326118824973938957093254L,14.3890071961733083876352461558L,
         -746.282584292240559108673580109L,13593.6408359290529338140336294L,
         -119401.455845765769481658935547L,596799.640898387879133224487305L,
         -1.87050639842196553945541381836e6L,3.90484064554001670330762863159e6L,
         -5.63768863639964908361434936523e6L,5.75144713185854628682136535645e6L,
         -4.17921401922353357076644897461e6L,2.150799241858178749680519104e6L,
         -766346.315792597830295562744141L,179873.854549337178468704223633L,
         -25026.9663985446095466613769531L,1564.18539990903809666633605957L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},
        {8.11429452840928678159360532407e-8L,
         -0.0119123151839745265466195565683L,7.10612678936079006504129480433L,
         -597.617709928813079992930094401L,16423.0416148178434620300928752L,
         -209622.247754308208823204040527L,1.49352025658822953701019287109e6L,
         -6.62142289729042258113622665405e6L,1.95704181437716981163248419762e7L,
         -4.03486028647377644665539264679e7L,5.97708936470264697913080453873e7L,
         -6.47708517052058363333344459534e7L,5.17651623663742344360798597336e7L,
         -3.04683917743325494229793548584e7L,1.30437078432276723906397819519e7L,
         -3.95023303397017065435647964478e6L,802125.2536724976380355656147L,
         -97982.7686557697597891092300415L,5443.48714754276443272829055786L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},
        {5.79596589007623181886659212099e-9L,
         -0.00280930474904062788164804852198L,3.15886031188824239911304579841L,
         -425.87811810855161479955154752L,17383.8190858998759404852217625L,
         -316136.250587442798709999474268L,3.1343125416359718189582169529e6L,
         -1.90945088419261503530414922843e7L,7.71713987311825488930769516007e7L,
         -2.17835842066086691367672756314e8L,4.44878698059055453931796364486e8L,
         -6.73263936461257004895014688373e8L,7.66622710599277669216098729521e8L,
         -6.61991914808377202425617724657e8L,4.33874700364649926341371610761e8L,
         -2.14357823427169361792039126158e8L,7.85174971086966893308272119612e7L,
         -2.06721486335191540274536237121e7L,3.6985528217368452533264644444e6L,
         -402647.387348632109933532774448L,20132.3693674316054966766387224L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},
        {3.78032850814193035617019190933e-10L,
         -0.000605795671054649920690627325149L,1.27857717182987904553079888934L,
         -274.143425643780227844780754475L,16437.159144436156588025845676L,
         -419887.581628552958569517137394L,5.69344947613846928700132550494e6L,
         -4.66873490393407008187274359876e7L,2.51793477376356557520618177174e8L,
         -9.4541943312380418551349846114e8L,2.57183416076726822087325022689e9L,
         -5.21392678282314736139596789144e9L,8.03487358480416738357689609984e9L,
         -9.5363838401354313907322648447e9L,8.78225595346152011073900212068e9L,
         -6.28846031953500596763478824869e9L,3.48854890553650872666776194819e9L,
         -1.48403138276638317539618583396e9L,4.74851065523436453329850337468e8L,
         -1.10558972638427478095763945021e8L,1.76780255707925570591214636806e7L,
         -1.73572527698159759347618091851e6L,78896.6034991635269761900417507L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},
        {2.26810373185766408401355062691e-11L,
         -0.000120343686175446240967179918702L,0.475536821286310487069886024574L,
         -161.240445431790778547626450351L,14085.8043169854693449548049654L,
         -500161.588230690085509065413914L,9.15704216638604516003689630972e6L,
         -9.95430376715402992676672511152e7L,7.03699090444964080479622176816e8L,
         -3.44204798947495145510402575642e9L,1.21719957899208831600868214602e10L,
         -3.21228850488519350187384523971e10L,6.47476607412014613600327639428e10L,
         -1.01348302748083245455918176958e11L,1.24609620654242303768030592437e11L,
         -1.21181649150999273173538995252e11L,9.34664775356634623585376147048e10L,
         -5.70852696302923664273442909689e10L,2.74310016235558941596873978597e10L,
         -1.02411623092222058270643856304e10L,2.90844494207502674373719742107e9L,
         -6.06911625287816924812318575277e8L,8.77165852533683674038798017136e7L,
         -7.84300346019537840754765056772e6L,326791.810841474100314485440322L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L},{1.25986748137855055741852183747e-12L,
         -0.0000221619887949193854484565676775L,0.163726163441359238462093458465L,
         -87.4375787931289241766993297918L,11062.5397285279138056172757946L,
         -541727.25965287877216270282589L,1.32618971514921121289121161727e7L,
         -1.88915021340931433800906110644e8L,1.72704308446434637362739782027e9L,
         -1.08341049502310320722695361868e10L,4.89140021005190672082546997636e10L,
         -1.64575268621924181785733798015e11L,4.23485473125307937448130040175e11L,
         -8.49655207411681856172686819819e11L,1.34817931539516586630349379195e12L,
         -1.70888315128898687047014365703e12L,1.74150361794423380942534547522e12L,
         -1.43123564502284014008034763066e12L,9.48274973152596067483929865934e11L,
         -5.04491430150664081370501051538e11L,2.13705890103873786526081662629e11L,
         -7.10665379736629443922415134693e10L,1.81400160323518201998129057984e10L,
         -3.42928045708353924623666841853e9L,4.52164710691244124795774794734e8L,
         -3.71133629975315987443096332754e7L,1.42743703836659995170421666444e6L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L},{6.51692658987584392333714885752e-14L,
         -3.8036291524292862470606489078e-6L,0.052504051511313178759378254588L,
         -44.0373198683661502037631557233L,8033.03681432854757626879589548L,
         -539252.1421709853962394122203L,1.75203388045304746697274376241e7L,
         -3.24128084833245630597781337974e8L,3.79201983405059056879558217298e9L,
         -3.01430823978213007979338568025e10L,1.71370230926644702449376970965e11L,
         -7.23608587713227185459911146012e11L,2.33456171094242547169816789472e12L,
         -5.88021800396337123113096312406e12L,1.17537987401216624049404747241e13L,
         -1.8875351533078282004760169388e13L,2.45701170231792508592048794843e13L,
         -2.60791233415396346568471292575e13L,2.26433404516507833101829600589e13L,
         -1.60901729613407403940299096804e13L,9.3349660857460651886773295237e12L,
         -4.39661681621692042739192193945e12L,1.66462210584273890955895289734e12L,
         -4.98928905474279237357691482835e11L,1.15637500507954779509584308683e11L,
         -1.99803662148571819012329142673e10L,2.42203537004720017829189182557e9L,
         -1.83728860710983003138274671784e8L,6.56174502539225011208123827799e6L,0L,0L,
         0L,0L,0L,0L,0L,0L},{3.15430828290460913090909475748e-15L,
         -6.11212400590773922770255924085e-7L,0.0157634869801633087791831187091L,
         -20.7230803090491614410890966505L,5431.93293020878908173017578579L,
         -497556.519430019607249501957144L,2.13293308578188815814220737739e7L,
         -5.08866272444616782034000463859e8L,7.556020455834870717175470676e9L,
         -7.53907259108300684196844727735e10L,5.33925730325869898174745792292e11L,
         -2.794890649215670019862435724e12L,1.11496923153108250035517452333e13L,
         -3.470416106622715935889997102e13L,8.58260639681232267421558262476e13L,
         -1.71034068383404630891536216402e14L,2.77609421437297601161729324391e14L,
         -3.69933245395597979435222352191e14L,4.06943469625495430683178231825e14L,
         -3.70736737996725940726660347987e14L,2.79997305922781428193501159221e14L,
         -1.7507793261361196081981642753e14L,9.02848002416969993155487633681e13L,
         -3.81320234668405903211285090565e13L,1.30480063013528096128237704341e13L,
         -3.55902604965942008318126215261e12L,7.55330408386027846300081099284e11L,
         -1.20168456274470132995052187586e11L,1.34796535054135450430325151444e10L,
         -9.5047478526025539979011663716e8L,3.16824928420085133263372212387e7L,0L,0L,
         0L,0L,0L,0L},{1.43360662614155980716067288734e-16L,
         -9.23292645167705185622606747958e-8L,0.00445054640583093715573891532878L,
         -9.15768937924438676491661706445L,3440.5476782983572290401147391L,
         -428481.13706629502260290744844L,2.41237927655841816130904710481e7L,
         -7.38051125334619306428796188176e8L,1.38180314428564281011504935407e10L,
         -1.71743637884021580028612354168e11L,1.5021386326397149816229836925e12L,
         -9.65335495969947680326159395543e12L,4.70989261804644299562236353109e13L,
         -1.78937513039019229579641302434e14L,5.39940553907584971012193798167e14L,
         -1.31432810212607973303974140774e15L,2.61263518101146964323182237075e15L,
         -4.28136988460356747890725874071e15L,5.82526458141613401923898219692e15L,
         -6.61429513320538108793870952054e15L,6.28734399561015020637266818257e15L,
         -5.01010155797467660704062957057e15L,3.34488386818692471720875494726e15L,
         -1.8661212750979656623999255648e15L,8.65696743112314570466260279413e14L,
         -3.31317318112524041265441464481e14L,1.03399914483864799300442552225e14L,
         -2.5873441490647371651354817233e13L,5.06383038672465526478931202556e12L,
         -7.46456170729975660916076005847e11L,7.79157357853775362701943147884e10L,
         -5.13230936397209815222501108969e9L,1.60384667624128067257031596553e8L,0L,0L,
         0L,0L},{6.13902999935462341423355402026e-18L,
         -1.31578087047974842564908107839e-8L,0.00118613236812067124481241944836L,
         -3.81657350146864434198303241898L,2051.29833569536162731747683013L,
         -346363.386234985840682599271679L,2.55170308981662674172864004267e7L,
         -9.96608075624626493431411721612e8L,2.34010420689704710067789085052e10L,
         -3.60083267495592573733506359746e11L,3.86240022908063663614704362708e12L,
         -3.02333106114255809552135376756e13L,1.78820725763265586672538328731e14L,
         -8.21093805959540262838763728931e14L,2.9898525664188372667202767071e15L,
         -8.78066420603534506857609116185e15L,2.10802582132763831057349854091e16L,
         -4.18163908868043065665937291238e16L,6.91185549405315745911183729564e16L,
         -9.5812503304135801475298879442e16L,1.11911163890336740889330557046e17L,
         -1.10482394136553038618222572114e17L,9.23318328635071027316901324591e16L,
         -6.53185865337347521496229107446e16L,3.90491469819067864071935875838e16L,
         -1.96573101337017752232111463549e16L,8.28435027207520758727672902298e15L,
         -2.89795862477239140462112415252e15L,8.31198749722804663137260624397e14L,
         -1.92099543153371220507437620145e14L,3.48809621488632800096886223881e13L,
         -4.78987729914568465643930554234e12L,4.67492456637937254240020468877e11L,
         -2.88917082763304189751174700617e10L,8.49756125774424087503455001814e8L,0L,
         0L},{2.48959854301550882962801578089e-19L,
         -1.7745942183127210987335303503e-9L,0.000299405373562301408355757403694L,
         -1.50561884893099522861572338385L,1156.00995409874525573804543918L,
         -264064.586990266836913820615205L,2.53814264307375445388015980414e7L,
         -1.26087919204649232262195308017e9L,3.69692028801362787460662683387e10L,
         -7.00720905404805734661343442164e11L,9.16485665885131304846535249941e12L,
         -8.68168207920699247065436676536e13L,6.18011580250398292766502356113e14L,
         -3.40222918850083182569762469496e15L,1.48167155919250813603733920028e16L,
         -5.19796662528819580244646477066e16L,1.49054583263826367296397490359e17L,
         -3.53509671381588992882455505843e17L,7.00026574310203518275281691947e17L,
         -1.16615823229243996921159240169e18L,1.64390188090700172062950937993e18L,
         -1.96955111858253354762721277218e18L,2.01154827367176435607791764841e18L,
         -1.7542436246127813793562047882e18L,1.30675758756765064838898691773e18L,
         -8.30602588736836403863107025372e17L,4.49336272799187098848766163155e17L,
         -2.05994507449074535620192469201e17L,7.95154797338133564735886737207e16L,
         -2.56091870936430568869659061896e16L,6.79449351940530999862331869244e15L,
         -1.4587501408373372812959612296e15L,2.47022700635653973589782500741e14L,
         -3.1747874161394451409880384992e13L,2.90956123256576972006868141148e12L,
         -1.69354305241617779174255755458e11L,4.70428625671160497706265987384e9L}
    };
    static const Real kurtcoeffs[19][37] = {
        {0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L},{8.L,-18.L,9.L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},{5.75L,-50.5L,106.25L,
         -81.L,20.25L,0L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},
        {2.95833333333333333333333333333L,-73.8125L,376.46875L,-752.4375L,
         704.203125L,-309.65625L,51.609375L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},{1.21354166666666666666666666667L,
         -74.7552083333333333333333333333L,780.893229166666666666666666667L,
         -3086.921875L,6003.01953125L,-6361.6171875L,3745.97265625L,-1151.015625L,
         143.876953125L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},
        {0.418229166666666666666666666667L,-58.8326171875L,1158.27275390625L,
         -8073.3623046875L,27443.476806640625L,-52534.67626953125L,
         60578.041748046875L,-42965.474609375L,18343.142822265625L,-4324.15283203125L,
         432.415283203125L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},
        {0.124696180555555555555555555556L,-38.2464789496527777777777777778L,
         1350.85271538628472222222222222L,-15599.7976725260416666666666667L,
         85262.1811482747395833333333333L,-262234.5843505859375L,
         497230.719462076822916666666667L,-609836.845703125L,493163.4617919921875L,
         -261295.7391357421875L,87288.46746826171875L,-16679.6982421875L,
         1389.974853515625L,0L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},
        {0.0327721974206349206349206349206L,-21.3192432221912202380952380952L,
         1308.22734825497581845238095238L,-24081.1082499186197916666666667L,
         201520.447060648600260416666667L,-934574.599647013346354166666667L,
         2.67721614160105387369791666667e6L,-5.04639351523844401041666666667e6L,
         6.48943063618214925130208333333e6L,-5.790530973907470703125e6L,
         3.5857510322265625e6L,-1.5122900873565673828125e6L,
         414474.823810577392578125L,-66565.53458404541015625L,
         4754.681041717529296875L,0L,0L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},
        {0.00769488622271825396825396825397L,-10.4457041180323040674603174603L,
         1089.52302622719416542658730159L,-31149.8770693097795758928571429L,
         386642.142534691946847098214286L,-2.599036452996063232421875e6L,
         1.07015771501453399658203125e7L,-2.9075554627471923828125e7L,
         5.46045338601531982421875e7L,-7.2918917646640777587890625e7L,
         7.02747185595874786376953125e7L,-4.90277772784271240234375e7L,
         2.45314121459064483642578125e7L,-8.5815332711200714111328125e6L,
         1.99270953053188323974609375e6L,-275948.57366180419921875L,
         17246.785853862762451171875L,0L,0L,0L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},
        {0.00163108112530313051146384479718L,-4.57827206843744510065310846561L,
         799.346247725133542661313657407L,-34855.0145927497318812779017857L,
         627748.103215935684385753813244L,-5.95548077365363401079934740823e6L,
         3.41180491829898745294601198227e7L,-1.28357494991866800520155164931e8L,
         3.34787843225419607427385118273e8L,-6.27345246591134428977966308594e8L,
         8.64056468872793058554331461589e8L,-8.86156730595170736312866210937e8L,
         6.79703121283103724320729573568e8L,-3.88240303523262381553649902344e8L,
         1.62729562511351883411407470703e8L,-4.859420606284618377685546875e7L,
         9.78544525733667612075805664063e6L,-1.19087777266037464141845703125e6L,
         66159.876258909702301025390625L,0L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},
        {0.000314795546220513668430335097002L,-1.81843643205716706667837852734L,
         525.727404226523017546907724317L,-34503.4124356345398716194919808L,
         887496.406858166213388796205874L,-1.16596083639457533283839150081e7L,
         9.08487380291426418477265292375e7L,-4.60541571280199312028430757068e8L,
         1.61410879596226243064517066592e9L,-4.07597660620791527628898620605e9L,
         7.62835433718905102908611297607e9L,-1.07822273836602095286051432292e10L,
         1.16417617846806479950745900472e10L,-9.64934935189494668443997701009e9L,
         6.13062983830293955902258555094e9L,-2.95981535383948349952697753906e9L,
         1.06641908221254836022853851318e9L,-2.7766579567427971959114074707e8L,
         4.93478817640941888093948364258e7L,-5.35610593052119016647338867187e6L,
         267805.296526059508323669433594L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},
        {0.0000557157667244744067660734327401L,
         -0.661090784789192498791040050806L,314.064758510646580961703566074L,
         -30721.9876662795490058010848111L,1.11539835247405243495469370847e6L,
         -2.00101040179989791018937630628e7L,2.08569952211833341263195194265e8L,
         -1.39704619766360606795580929549e9L,6.42869982892890571801474800816e9L,
         -2.12808918985220508507319859096e10L,5.23497607050106681336604413532e10L,
         -9.79195193704881459958851337433e10L,1.41491226964514212600079675515e11L,
         -1.59542598521807158685103058815e11L,1.41092397297485010681860148907e11L,
         -9.78778777323389377593994140625e10L,5.2991038859992506515234708786e10L,
         -2.21337208794477364383637905121e10L,6.98906560754662665911018848419e9L,
         -1.61265562332230789586901664734e9L,2.56451379855482843704521656036e8L,
         -2.51169426699096355587244033813e7L,1.14167921226861979812383651733e6L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},{9.09911924256881396638341082786e-6L,
         -0.221733689333662772177375686219L,172.162016985662330092703867338L,
         -24918.517368028283809667522754L,1.26564251830589181723702368645e6L,
         -3.06777275482734500827691542408e7L,4.22441842219308080214389470099e8L,
         -3.68459214817739458732977115288e9L,2.18848560226703483235307786831e10L,
         -9.30928189672431507531050888319e10L,2.94023283138317095571373485857e11L,
         -7.0783858508439473481374600577e11L,1.32388020912549829549752323637e12L,
         -1.94982461868550944269300541944e12L,2.28177535894638972610872135394e12L,
         -2.13226621628328038646740218004e12L,1.5929436539163766181471835201e12L,
         -9.4865172397805568989273160696e11L,4.46993878309076123063607762257e11L,
         -1.64416455051814562057144939899e11L,4.61887191662341339222621172667e10L,
         -9.56661895509222135460004210472e9L,1.37635398730945628439076244831e9L,
         -1.22805348413334882818162441254e8L,5.1168895172222867840901017189e6L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L,0L,0L},{1.37854670626310980043618932508e-6L,
         -0.0690582871400490537335609446103L,87.3045406363051809922596370916L,
         -18594.5476190105814635168288559L,1.31223594567111300266772199226e6L,
         -4.26243227797489459825367128474e7L,7.67990223235081051594211106365e8L,
         -8.62522742391042970270320865107e9L,6.52727082479078912054180644775e10L,
         -3.51480198692716452234865735388e11L,1.40079555935712018490149014353e12L,
         -4.25371259385992278699006160928e12L,1.00573066049423355988948325696e13L,
         -1.88147945763151834041071822867e13L,2.81772216821918849398962959337e13L,
         -3.40538664756233057755537641545e13L,3.33724566908996611840549875827e13L,
         -2.65653281084193850753262871876e13L,1.71527486610337520984234210725e13L,
         -8.93940080995225466996045239891e12L,3.72610690967099202078281571933e12L,
         -1.22388079064069610029869363643e12L,3.09572884758788196777444682084e11L,
         -5.81562913319544964703964069486e10L,7.63847664468249241205921862274e9L,
         -6.25835740702126607095124199986e8L,2.4070605411620254119043238461e7L,0L,0L,
         0L,0L,0L,0L,0L,0L,0L,0L},{1.94668400663808979316171776489e-7L,
         -0.0200794874637445723200741688551L,41.2268593558527859052060148347L,
         -12867.279202521007365136896382L,1.25500596394950898059417775107e6L,
         -5.42795849794215626826337030217e7L,1.26998957216505436446046039078e9L,
         -1.82048505562851921564748980187e10L,1.73763301137229756002955333773e11L,
         -1.17080960131321568936195306753e12L,5.8103537790508249882642643772e12L,
         -2.19192672185884961316456505166e13L,6.43766273797313899447677778813e13L,
         -1.49899754233137506266876504351e14L,2.80557892006263668191033345663e14L,
         -4.26413656187431495294492871922e14L,5.30110538929863735307428851575e14L,
         -5.41520105107795121355113922618e14L,4.55484882172485727670770870949e14L,
         -3.15316724932445254025478890981e14L,1.79081065139922303012027205114e14L,
         -8.29113796549872476606538330088e13L,3.0969328773727590360780381161e13L,
         -9.18602955552618326135579263791e12L,2.11268190168224138865106215235e12L,
         -3.63081856931809203246863035019e11L,4.38666438257563449163244513329e10L,
         -3.32243966896519557511783204973e9L,1.18658559605899841968494001776e8L,0L,0L,
         0L,0L,0L,0L,0L,0L},{2.57302495209279186162039998019e-8L,
         -0.00547555756618909382911170211318L,18.2279530857737818376729038077L,
         -8310.70487163579264500721640719L,1.11565273308130311326437748236e6L,
         -6.3922957027009504319866807242e7L,1.93048418419185936587340222612e9L,
         -3.50734847425555781759200396581e10L,4.18852620229211528332812100802e11L,
         -3.4991301295306893230018922968e12L,2.13987297280018708722077326074e13L,
         -9.91054973583539480834065224328e13L,3.56729642832733641332624810189e14L,
         -1.01810106742848836230234355459e15L,2.3397783535270273593296444652e15L,
         -4.38197307036943079770105694308e15L,6.74826640371632214525469156458e15L,
         -8.60166394282920634062448820689e15L,9.11424434142642195014848505168e15L,
         -8.04609895780190963628098890654e15L,5.91913599549099504996506381071e15L,
         -3.6213636175620332889972704795e15L,1.83437288676157293876779734625e15L,
         -7.63611478722774855216371051938e14L,2.58300907521124540540998219361e14L,
         -6.98296429749599755270155910694e13L,1.47217782343440935323672902086e13L,
         -2.33128235024003260727795077401e12L,2.60750528715975808767639364305e11L,
         -1.83610804943619090081870126596e10L,6.12036016478730300272900421987e8L,0L,
         0L,0L,0L,0L,0L},{3.19520876656535576662193932366e-9L,
         -0.00140590331614618414089550814137L,7.580617941244477462981814022L,
         -5036.99033345287919163864721923L,927643.090396631102643098017761L,
         -7.01265815344914827320648842829e7L,2.72037335769402087150977781205e9L,
         -6.22881586662858637270040949333e10L,9.24639270932976650987041423139e11L,
         -9.5066510866254138042548275554e12L,7.10449703811928582016208811749e13L,
         -4.00158930448491075484492235332e14L,1.74660860704150912598802569339e15L,
         -6.03689085051499681274795213997e15L,1.68056462993092205822744841668e16L,
         -3.81871832275099986236417971491e16L,7.15703844283188503686178293754e16L,
         -1.11528633047911631682739616627e17L,1.45364473715521009807443054162e17L,
         -1.59119139599891797453239105614e17L,1.46620617021737128404985924612e17L,
         -1.13801179254329241968257989553e17L,7.43144171987483705992995374703e16L,
         -4.07020701805561594294838004162e16L,1.85962148316866421686998456547e16L,
         -7.02932569386071553774076694079e15L,2.17211338607626648250652409096e15L,
         -5.39341349048801616988944274908e14L,1.04949150021051838249210285994e14L,
         -1.54077759143810411690806955676e13L,1.60419382109009379170472055876e12L,
         -1.05542060381683137361486842565e11L,3.29818938692759804254646383015e9L,0L,
         0L,0L,0L},{3.7405179940969095608341172018e-10L,
         -0.000341058893042362996494000145569L,2.97703135970679976754435828799L,
         -2877.71973536126285368504904188L,725210.642929437617995285256069L,
         -7.20979681566450054708034266699e7L,3.57842846958443347284611585595e9L,
         -1.02783616968380141718341456461e11L,1.88652552096407418153774327938e12L,
         -2.3727206424626377053438793832e13L,2.15212841806151405948899269215e14L,
         -1.46296124320732533111570987895e15L,7.67706116964737408476046260856e15L,
         -3.18280540016805768984586233968e16L,1.06177992184400019739674159413e17L,
         -2.89204380098578075297297250455e17L,6.50687546953780500190656035711e17L,
         -1.22050625106445898162642379805e18L,1.92233362870043491954247937623e18L,
         -2.55620413365125949663970716465e18L,2.88077773728995587368979535978e18L,
         -2.75802362924071027778189282955e18L,2.24521807970591895640190932423e18L,
         -1.55326596483869373800889259248e18L,9.11214090471365983222247833556e17L,
         -4.51497634373692001950570800978e17L,1.87794367202946864785295279745e17L,
         -6.49899284234254228541406342564e16L,1.84802980843435165200726940591e16L,
         -4.24227384638473419697196429575e15L,7.6640276862779842961916117034e14L,
         -1.04866732843826181295620848118e14L,1.0212003732587762474983913652e13L,
         -6.30447121019835846317796558935e11L,1.85425623829363484211116634981e10L,0L,
         0L},{4.14069524749690535878321599767e-11L,
         -0.0000784097605054450041268271040522L,1.10776271042037954787887328213L,
         -1555.75842819568893906946903638L,535410.177868359456197928309736L,
         -6.98165862062761167069055586908e7L,4.41927218943611708359891045292e9L,
         -1.58628773572912956412108894613e11L,3.58411365247430994064930554336e12L,
         -5.4868270719551690047045937835e13L,6.00636818795669115007311491934e14L,
         -4.89671277279540105676113596778e15L,3.06770839155571747610354004854e16L,
         -1.51366306615637133169140721151e17L,5.99865288910615739830865021711e17L,
         -1.9396104433451221362010581919e18L,5.18225495099853483657761859285e18L,
         -1.15587038909565523452897708761e19L,2.16993927783153418650052999907e19L,
         -3.45102494883600427047417630987e19L,4.67273241844774108111880641633e19L,
         -5.40612924397892169631318245699e19L,5.35690411641217209960986825107e19L,
         -4.55131679922781128323500238409e19L,3.31510517966616632091904037786e19L,
         -2.06709866449997336776736783473e19L,1.10016491369294470159839211221e19L,
         -4.97479229688973768822164152013e18L,1.89844195317933640294692861747e18L,
         -6.05695420535318392061742085408e17L,1.59485318419150793117299038623e17L,
         -3.40375684543189911456294965717e16L,5.73803797853060886888649091341e15L,
         -7.35121982385931886495025168012e14L,6.72359118069673864458390785055e13L,
         -3.90982945979233425041219370044e12L,1.08606373883120395844783158346e11L}
    };
    static const unsigned maxdeg = 18U;

    assert(o >= 0.0L);
    assert(f0 >= 0.0L);
    assert(mean);
    assert(var);
    assert(skew);
    assert(kurt);
    assert(dskewdo);
    assert(dskewdf0);
    assert(dkurtdo);
    assert(dkurtdf0);

    Real ocoeffs[19], derivcoeffs[19];
    unsigned i;

    /* Calculate the mean */
    const Real twof0 = 2.0L*f0;
    for (i=0; i<=maxdeg; ++i)
        ocoeffs[i] = polySeriesSum(&meancoeffs[i][0], maxdeg*2, twof0);
    *mean = polySeriesSum(ocoeffs, maxdeg, o);

    /* Calculate the variance */
    for (i=0; i<=maxdeg; ++i)
        ocoeffs[i] = polySeriesSum(&varcoeffs[i][0], maxdeg*2, twof0);
    *var = polySeriesSum(ocoeffs, maxdeg, o);

    /* Skewness calculation */
    if (o > 0.0)
    {
        const Real a = 1.0L/sqrtl(o);
        Real tmp, ldskew, lddskewdo, lddskewdf0, fac;

        for (i=0; i<=maxdeg; ++i)
            polyAndDeriv(&skewcoeffs[i][0], maxdeg*2, twof0,
                           ocoeffs+i, derivcoeffs+i);
        polyAndDeriv(ocoeffs, maxdeg, o, &tmp, &lddskewdo);
        lddskewdf0 = polySeriesSum(derivcoeffs, maxdeg, o);

        fac = (1.0L - twof0)/a/SQRT2L;
        ldskew = fac*tmp;
        lddskewdo = fac*(lddskewdo + tmp/o/2.0L);
        lddskewdf0 = 2.0L*(lddskewdf0*fac - tmp/a/SQRT2L);

        *skew = ldskew;
        *dskewdo = lddskewdo;
        *dskewdf0 = lddskewdf0;
    }
    else
    {
        *skew = 0.0;
        *dskewdo = 0.0;
        *dskewdf0 = 0.0;
    }

    /* Kurtosis calculation */
    {
        Real ldkurt, lddkurtdo, lddkurtdf0;

        for (i=0; i<=maxdeg; ++i)
            polyAndDeriv(&kurtcoeffs[i][0], maxdeg*2, twof0,
                           ocoeffs+i, derivcoeffs+i);
        polyAndDeriv(ocoeffs, maxdeg, o, &ldkurt, &lddkurtdo);
        lddkurtdf0 = polySeriesSum(derivcoeffs, maxdeg, o);
        lddkurtdf0 *= 2.0L;
        ldkurt += 3.0L;

        *kurt = ldkurt;
        *dkurtdo = lddkurtdo;
        *dkurtdf0 = lddkurtdf0;
    }

    return true;
    }

    bool SbMomentsMultiZone::integrate6(
        const Real a, const Real b, Real *results) const
    {
        // Process the trivial case of a = 0
        if (a == 0.0L)
        {
            const Real res = erfcl(b)/2.0L;
            for (unsigned j=0; j<6; ++j)
                results[j] = res;
            return true;
        }

        for (unsigned j=0; j<6; ++j)
            results[j] = 0.0L;

        // Evaluate positive side tails
        Real ptail[6];
        {
            Real ptail_coeff[6][TAILTERMS];
            int npos = 0;
            for (; npos<TAILTERMS; ++npos)
            {
                const Real erfc_factor = erfc_exp_factor(a + b + npos/2.0L/a);
                const Real leading_exp = -((a + b)*(a + b) + npos);
                const Real dtmp = expl(leading_exp)*erfc_factor;
                if (dtmp < std::numeric_limits<Real>::min())
                    break;
                for (unsigned j=0; j<6; ++j)
                    ptail_coeff[j][npos] = dtmp*pos_tail_coeff[j][npos];
            }

            for (unsigned j=0; j<6; ++j)
            {
                Real sum=0.0L;
                for (int i=npos-1; i>=0; --i)
                    sum += ptail_coeff[j][i];
                ptail[j] = sum/2.0L;
            }
        }

        // Evaluate negative side tails
        Real ntail[6];
        {
            Real ntail_coeff[6][TAILTERMS];
            int nneg = 1;
            for (; nneg<TAILTERMS; ++nneg)
            {
                const Real di = nneg/2.0L/a;
                const Real erfc_arg = -b + a + di;
                Real erfc_factor, leading_exp;
                if (erfc_arg >= 0.0L)
                {
                    erfc_factor = erfc_exp_factor(erfc_arg);
                    leading_exp = -((a - b)*(a - b) + nneg);
                }
                else
                {
                    erfc_factor = erfcl(erfc_arg);
                    leading_exp = di*di - nneg*b/a;
                }
                const Real dtmp = expl(leading_exp)*erfc_factor;

                int lastcoeff = 0;
                for (unsigned j=0; j<6; ++j)
                    if (neg_tail_coeff[j][nneg])
                    {
                        lastcoeff = neg_tail_coeff[j][nneg];
                        ntail_coeff[j][nneg] = dtmp*lastcoeff;
                    }
                    else
                        ntail_coeff[j][nneg] = 0.0L;

                if (lastcoeff)
                {
                    if (dtmp < std::numeric_limits<Real>::min())
                        break;
                    if (leading_exp >= max_exponent ||
                        dtmp > std::numeric_limits<Real>::max()/
                               std::abs(lastcoeff))
                    {
                        // Insufficient dynamic range.
                        // Can't do much about it here.
                        return false;
                    }
                }
            }

            for (unsigned j=0; j<6; ++j)
            {
                Real sum = 0.0L;
                for (int i=nneg-1; i>0; --i)
                    sum += ntail_coeff[j][i];
                ntail[j] = sum/2.0L;
            }
        }

        // Evaluate the central part of the integral
        Real center[6];
	if (a <= SMALL_A_BOUND)
        {
#ifdef VERBOSE_CALC
            std::cout << "SbMomentsMultiZone::integrate6: small a case: a = "
                      << a << ", b = " << b << std::endl;
#endif
            const Real xmin = b-a;
            const Real xmax = b+a;
            for (unsigned j=0; j<6; ++j)
                center[j] = quad_.integrate(
                    SbMomentsGaussFunctor(a, b, j+1U), xmin, xmax);
        }
	else
        {
#ifdef VERBOSE_CALC
            std::cout << "SbMomentsMultiZone::integrate6: big a case: a = "
                      << a << ", b = " << b << std::endl;
#endif
	    central_integ_big_a(a, b, center);
        }

        // Sum up the terms
        for (unsigned j=0; j<6; ++j)
        {
// #ifdef VERBOSE_CALC
//             std::cout << "j = " << j
//                       << ": " << ptail[j] 
//                       << ' ' << center[j] << ' ' << ntail[j]
//                       << std::endl;
// #endif
            results[j] = ptail[j] + center[j] + ntail[j];
            if (my_inf_nan(results[j]))
            {
                for (unsigned k=0; k<6; ++k)
                    results[k] = 0.0L;
                return false;
            }
        }

        return true;
    }

    void SbMomentsMultiZone::central_integ_big_a(
        const Real a, const Real b, Real* p) const
    {
        // This code has poor convergence properties and
        // should not really be used...
        const Real xmin = 0.5L*(1.0L + erfl(b - a));
        const Real xmax = 0.5L*(1.0L + erfl(b + a));
        for (unsigned j=0; j<6; ++j)
            p[j] = quad_.integrate(
                SbMomentsInvErfFunctor(a, b, j+1U), xmin, xmax);
    }

    bool SbMomentsMix::integrate6(
        const long double a, const long double b, long double *results) const
    {
        bool status1 = true, status2 = true;

        if (a >= 1.0L)
        {
#ifdef VERBOSE_CALC
            std::cout << "SbMomentsMix::integrate6: using GaussHermite"
                      << std::endl;
#endif
            status1 = gh.integrate6(a, b, results);
        }
        else if (a <= mixPoint_)
        {
#ifdef VERBOSE_CALC
            std::cout << "SbMomentsMix::integrate6: using MultiZone"
                      << std::endl;
#endif
            status2 = mz.integrate6(a, b, results);
        }
        else
        {
#ifdef VERBOSE_CALC
            std::cout << "SbMomentsMix::integrate6: using calculator mix"
                      << std::endl;
#endif
            long double resHerm[6], resMulti[6];
            status1 = gh.integrate6(a, b, resHerm);
            status2 = mz.integrate6(a, b, resMulti);
            const long double wh = (a - mixPoint_)/(1.0L - mixPoint_);
            const long double wm = 1.0L - wh;
            for (unsigned i=0; i<6; ++i)
                results[i] = wh*resHerm[i] + wm*resMulti[i];
        }

#ifdef VERBOSE_CALC
        if (!status1)
        {
            std::cout << "WARNING in SbMomentsMix::integrate6: "
                      << "GaussHermite calculator failed for a = " 
                      << a << ", b = " << b << std::endl;
        }
        if (!status2)
        {
            std::cout << "WARNING in SbMomentsMix::integrate6: "
                      << "MultiZone calculator failed for a = " 
                      << a << ", b = " << b << std::endl;
        }        
#endif

        return status1 && status2;
    }

    SbMomentsMix::SbMomentsMix(double mixPoint, unsigned npointsHemite,
                               unsigned npointsLegendre)
        : gh(npointsHemite),
          mz(npointsLegendre),
          mixPoint_(mixPoint)
    {
    }
}
